
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/train_tree.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_train_tree.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_train_tree.py:


Train and evaluate a TreeClassifier on golf weather data

.. GENERATED FROM PYTHON SOURCE LINES 4-31

.. code-block:: Python

    import pandas as pd
    from sklearn.metrics import accuracy_score
    from sklearn_nominal import TreeClassifier

    def read_classification_dataset(url: str):
        df = pd.read_csv(url)
        x = df.iloc[:, :-1]
        y = df.iloc[:, -1]
        return x, y, y.unique()

    dataset_name = "golf_classification"
    url_base = "https://raw.githubusercontent.com/facundoq/facundoq.github.io/refs/heads/master/"
    url = url_base + "datasets/classification/golf_classification_numeric.csv"
    x, y, class_names = read_classification_dataset(url)

    # custom hiperparameters
    model = TreeClassifier(criterion="entropy", max_depth=4, min_samples_leaf=1, min_error_decrease=1e-16)

    # Fit and evaluate on training data
    model.fit(x, y)
    y_pred = model.predict(x)
    print(f"Dataset {dataset_name:40} accuracy: {accuracy_score(y, y_pred) * 100:.2f}%")

    # Print tree
    print(model.pretty_print(class_names=class_names))

    # Export tree as png
    model.export_image("examples/tree.png", title=f"{model}", class_names=class_names)

.. _sphx_glr_download_auto_examples_train_tree.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: train_tree.ipynb <train_tree.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: train_tree.py <train_tree.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: train_tree.zip <train_tree.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
